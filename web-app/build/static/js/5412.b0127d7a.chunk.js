"use strict";(self.webpackChunkweb_app=self.webpackChunkweb_app||[]).push([[5412],{2311:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setUpSocketIOPing=t.appendQueryParams=t.parseSocketIOUrl=void 0;var r=n(94494);t.parseSocketIOUrl=function(e){if(e){var t=/^https|wss/.test(e),n=e.replace(/^(https?|wss?)(:\/\/)?/,"").replace(/\/$/,"");return"".concat(o=t?"wss":"ws","://").concat(n).concat(r.SOCKET_IO_PATH)}if(""===e){var o=(t=/^https/.test(window.location.protocol))?"wss":"ws",a=window.location.port?":".concat(window.location.port):"";return"".concat(o,"://").concat(window.location.hostname).concat(a).concat(r.SOCKET_IO_PATH)}return e};t.appendQueryParams=function(e,t){void 0===t&&(t={});var n=/\?([\w]+=[\w]+)/.test(e),r="".concat(Object.entries(t).reduce(function(e,t){var n=t[0],r=t[1];return e+"".concat(n,"=").concat(r,"&")},"").slice(0,-1));return"".concat(e).concat(n?"&":"?").concat(r)};t.setUpSocketIOPing=function(e,t){void 0===t&&(t=r.SOCKET_IO_PING_INTERVAL);return window.setInterval(function(){return e(r.SOCKET_IO_PING_CODE)},t)}},2915:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.assertIsWebSocket=function(e,t){if(!t&&e instanceof WebSocket===!1)throw new Error("")},t.resetGlobalState=function(e){(0,o.resetSubscribers)(e),(0,r.resetWebSockets)(e)};var r=n(64035),o=n(38642)},5412:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var r=n(9950),o=n(43217),a=n(98341),c=n(89132),s=n(99491),u=n(59908),i=n(31690),l=n(64928),d=n(49078),f=n(30272),p=n(82817),v=n(70503),h=n(36811),S=n(44414);const b=()=>{const e=(0,s.jL)(),t=(0,a.d4)(e=>e.trace.messages),n=(0,a.d4)(e=>e.trace.traceStarted),[b,y]=(0,r.useState)(""),[E,O]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[_,T]=(0,r.useState)(""),[w,N]=(0,r.useState)(0),[C,x]=(0,r.useState)(!1),[R,I]=(0,r.useState)(!0),[k,A]=(0,r.useState)(!1),[j,P]=(0,r.useState)(!1),[L,M]=(0,r.useState)(!1),[D,W]=(0,r.useState)(!1),[U,F]=(0,r.useState)(!1),[J,G]=(0,r.useState)(!1),[B,z]=(0,r.useState)("");(0,r.useEffect)(()=>{const e=new URL(window.location.toString()),t=(0,i.nw)(e.protocol),n=e.port,r=C?"all":(()=>{const e=[];return R&&e.push("s3"),k&&e.push("internal"),j&&e.push("storage"),L&&e.push("os"),e.join(",")})(),o=new URL(document.baseURI).pathname,a=new URL("".concat(t,"://").concat(e.hostname,":").concat(n).concat(o,"ws/trace"));a.searchParams.append("calls",r),a.searchParams.append("threshold",w.toString()),a.searchParams.append("onlyErrors",D?"yes":"no"),a.searchParams.append("statusCode",b),a.searchParams.append("method",E),a.searchParams.append("funcname",m),a.searchParams.append("path",_),z(a.href)},[C,R,k,j,L,w,D,b,E,m,_]);const{sendMessage:H,lastJsonMessage:K,readyState:V}=(0,h.Ay)(B,{heartbeat:{message:"ok",interval:1e4,timeout:31536e6}},J);return(0,r.useEffect)(()=>{V===h.vj.CONNECTING?e((0,l.rZ)()):V===h.vj.OPEN?e((0,l.p)(!0)):V===h.vj.CLOSED&&e((0,l.p)(!1))},[V,e,H]),(0,r.useEffect)(()=>{K&&(K.ptime=o.c9.fromISO(K.time).toJSDate(),K.key=Math.random(),e((0,l.cI)(K)))},[K,e]),(0,r.useEffect)(()=>{e((0,d.ph)("trace"))},[]),(0,S.jsxs)(r.Fragment,{children:[(0,S.jsx)(p.A,{label:"Trace",actions:(0,S.jsx)(v.A,{})}),(0,S.jsx)(c.Mxu,{children:(0,S.jsx)(c.azJ,{withBorders:!0,children:(0,S.jsxs)(c.xA9,{container:!0,children:[(0,S.jsxs)(c.xA9,{item:!0,xs:12,sx:{display:"flex",flexFlow:"column","& .trace-Checkbox-label":{fontSize:"14px",fontWeight:"normal"}},children:[(0,S.jsx)(c.azJ,{sx:{fontSize:"16px",fontWeight:600,padding:"20px 0px 20px 0"},children:"Calls to Trace"}),(0,S.jsxs)(c.azJ,{className:"".concat(n?"inactive-state":""),sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,S.jsxs)(c.azJ,{sx:{display:"flex",flexFlow:"row","& .trace-checked-icon":{border:"1px solid red"},["@media (min-width: ".concat(c.nmC.md,"px)")]:{gap:30}},children:[(0,S.jsx)(c.Sc0,{checked:C,id:"all_calls",name:"all_calls",label:"All",onChange:()=>x(!C),value:"all",disabled:n}),(0,S.jsx)(c.Sc0,{checked:R||C,id:"s3_calls",name:"s3_calls",label:"S3",onChange:()=>I(!R),value:"s3",disabled:C||n}),(0,S.jsx)(c.Sc0,{checked:k||C,id:"internal_calls",name:"internal_calls",label:"Internal",onChange:()=>A(!k),value:"internal",disabled:C||n}),(0,S.jsx)(c.Sc0,{checked:j||C,id:"storage_calls",name:"storage_calls",label:"Storage",onChange:()=>P(!j),value:"storage",disabled:C||n}),(0,S.jsx)(c.Sc0,{checked:L||C,id:"os_calls",name:"os_calls",label:"OS",onChange:()=>M(!L),value:"os",disabled:C||n})]}),(0,S.jsxs)(c.azJ,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"15px"},children:[(0,S.jsx)(f.A,{tooltip:"More filter options",children:(0,S.jsx)(c.$nd,{id:"filter-toggle",onClick:()=>F(!U),label:"Filters",icon:(0,S.jsx)(c.YGH,{}),variant:"regular",className:"filters-toggle-button",style:{width:"118px",background:U?"rgba(8, 28, 66, 0.04)":""}})}),!n&&(0,S.jsx)(c.$nd,{id:"start-trace",label:"Start","data-test-id":"trace-start-button",variant:"callAction",onClick:()=>G(!0),style:{width:"118px"}}),n&&(0,S.jsx)(c.$nd,{id:"stop-trace",label:"Stop Trace","data-test-id":"trace-stop-button",variant:"callAction",onClick:()=>G(!1),style:{width:"118px"}})]})]})]}),U?(0,S.jsxs)(c.azJ,{useBackground:!0,className:"".concat(n?"inactive-state":""),sx:{marginTop:"25px",display:"flex",flexFlow:"column",padding:"30px",width:"100%","& .orient-vertical":{flexFlow:"column","& label":{marginBottom:"10px",fontWeight:600},"& .inputRebase":{width:"90%"}},"& .trace-Checkbox-label":{fontSize:"14px",fontWeight:"normal"}},children:[(0,S.jsxs)(c.azJ,{sx:{display:"flex"},children:[(0,S.jsx)(c.cl_,{className:"orient-vertical",id:"trace-status-code",name:"trace-status-code",label:"Status Code",placeholder:"e.g. 503",value:b,onChange:e=>y(e.target.value),disabled:n}),(0,S.jsx)(c.cl_,{className:"orient-vertical",id:"trace-function-name",name:"trace-function-name",label:"Function Name",placeholder:"e.g. FunctionName2055",value:m,onChange:e=>g(e.target.value),disabled:n}),(0,S.jsx)(c.cl_,{className:"orient-vertical",id:"trace-method",name:"trace-method",label:"Method",placeholder:"e.g. Method 2056",value:E,onChange:e=>O(e.target.value),disabled:n})]}),(0,S.jsxs)(c.azJ,{sx:{gap:"30px",display:"grid",gridTemplateColumns:"2fr 1fr",width:"100%",marginTop:"33px"},children:[(0,S.jsx)(c.azJ,{sx:{flex:2,width:"calc( 100% + 10px)"},children:(0,S.jsx)(c.cl_,{className:"orient-vertical",id:"trace-path",name:"trace-path",label:"Path",placeholder:"e.g. my-bucket/my-prefix/*",value:_,onChange:e=>T(e.target.value),disabled:n})}),(0,S.jsx)(c.azJ,{sx:{marginLeft:"15px"},children:(0,S.jsx)(c.cl_,{className:"orient-vertical",id:"trace-fthreshold",name:"trace-fthreshold",label:"Response Threshold",type:"number",placeholder:"e.g. website.io.3249.114.12",value:"".concat(w),onChange:e=>N(parseInt(e.target.value)),disabled:n})})]}),(0,S.jsx)(c.azJ,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-start",marginTop:"40px"},children:(0,S.jsx)(c.Sc0,{checked:D,id:"only_errors",name:"only_errors",label:"Display only Errors",onChange:()=>W(!D),value:"only_errors",disabled:n})})]}):null,(0,S.jsx)(c.xA9,{item:!0,xs:12,children:(0,S.jsx)(c.azJ,{sx:{fontSize:"16px",fontWeight:600,marginBottom:"30px",marginTop:"30px"},children:"Trace Results"})}),(0,S.jsx)(c.xA9,{item:!0,xs:12,children:(0,S.jsx)(c.bQt,{columns:[{label:"Time",elementKey:"ptime",renderFunction:e=>{const t=new Date(e);return(0,u.cj)(t)},width:100},{label:"Name",elementKey:"api"},{label:"Status",elementKey:"",renderFunction:e=>"".concat(e.statusCode," ").concat(e.statusMsg),renderFullObject:!0},{label:"Location",elementKey:"configuration_id",renderFunction:e=>"".concat(e.host," ").concat(e.client),renderFullObject:!0},{label:"Load Time",elementKey:"callStats.duration",width:150},{label:"Upload",elementKey:"callStats.rx",renderFunction:u.nO,width:150},{label:"Download",elementKey:"callStats.tx",renderFunction:u.nO,width:150}],isLoading:!1,records:t,entityName:"Traces",idField:"api",customEmptyMessage:n?"No Traced elements received yet":"Trace is not started yet",customPaperHeight:"calc(100vh - 292px)",autoScrollToBottom:!0})})]})})})]})}},5605:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.useSocketIO=void 0;var o=n(9950),a=n(44574),c=n(94494),s={type:"empty",payload:null};t.useSocketIO=function(e,t,n){void 0===t&&(t=c.DEFAULT_OPTIONS),void 0===n&&(n=!0);var u=(0,o.useMemo)(function(){return r(r({},t),{fromSocketIO:!0})},[]),i=(0,a.useWebSocket)(e,u,n),l=i.sendMessage,d=i.sendJsonMessage,f=i.lastMessage,p=i.readyState,v=i.getWebSocket,h=(0,o.useMemo)(function(){return function(e){if(!e||!e.data)return s;var t=e.data.match(/\[.*]/);if(!t)return s;var n=JSON.parse(t);return Array.isArray(n)&&n[1]?{type:n[0],payload:n[1]}:s}(f)},[f]);return{sendMessage:l,sendJsonMessage:d,lastMessage:h,lastJsonMessage:h,readyState:p,getWebSocket:v}}},18911:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.attachListeners=void 0;var o=n(2311),a=n(73647),c=n(94494),s=n(2915);t.attachListeners=function(e,t,n,u,i,l,d){var f,p,v,h=t.setLastMessage,S=t.setReadyState;return n.current.fromSocketIO&&(f=(0,o.setUpSocketIOPing)(d)),function(e,t,n,r){e.onmessage=function(e){var o;t.current.onMessage&&t.current.onMessage(e),"number"===typeof(null===r||void 0===r?void 0:r.current)&&(r.current=Date.now()),"function"===typeof t.current.filter&&!0!==t.current.filter(e)||t.current.heartbeat&&"boolean"!==typeof t.current.heartbeat&&(null===(o=t.current.heartbeat)||void 0===o?void 0:o.returnMessage)===e.data||n(e)}}(e,n,h,l),function(e,t,n,r,o){e.onopen=function(s){if(t.current.onOpen&&t.current.onOpen(s),r.current=0,n(c.ReadyState.OPEN),t.current.heartbeat&&e instanceof WebSocket){var u="boolean"===typeof t.current.heartbeat?void 0:t.current.heartbeat;o.current=Date.now(),(0,a.heartbeat)(e,o,u)}}}(e,n,S,i,l),p=function(e,t,n,r,o){return c.isEventSourceSupported&&e instanceof EventSource?function(){}:((0,s.assertIsWebSocket)(e,t.current.skipAssert),e.onclose=function(e){var s;if(t.current.onClose&&t.current.onClose(e),n(c.ReadyState.CLOSED),t.current.shouldReconnect&&t.current.shouldReconnect(e)){var u=null!==(s=t.current.reconnectAttempts)&&void 0!==s?s:c.DEFAULT_RECONNECT_LIMIT;if(o.current<u){var i="function"===typeof t.current.reconnectInterval?t.current.reconnectInterval(o.current):t.current.reconnectInterval;a=window.setTimeout(function(){o.current++,r()},null!==i&&void 0!==i?i:c.DEFAULT_RECONNECT_INTERVAL_MS)}else t.current.onReconnectStop&&t.current.onReconnectStop(u),console.warn("Max reconnect attempts of ".concat(u," exceeded"))}},function(){return a&&window.clearTimeout(a)});var a}(e,n,S,u,i),v=function(e,t,n,o,a){var s;return e.onerror=function(u){var i;if(t.current.onError&&t.current.onError(u),c.isEventSourceSupported&&e instanceof EventSource&&(t.current.onClose&&t.current.onClose(r(r({},u),{code:1006,reason:"An error occurred with the EventSource: ".concat(u),wasClean:!1})),n(c.ReadyState.CLOSED),e.close()),t.current.retryOnError)if(a.current<(null!==(i=t.current.reconnectAttempts)&&void 0!==i?i:c.DEFAULT_RECONNECT_LIMIT)){var l="function"===typeof t.current.reconnectInterval?t.current.reconnectInterval(a.current):t.current.reconnectInterval;s=window.setTimeout(function(){a.current++,o()},null!==l&&void 0!==l?l:c.DEFAULT_RECONNECT_INTERVAL_MS)}else t.current.onReconnectStop&&t.current.onReconnectStop(t.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(t.current.reconnectAttempts," exceeded"))},function(){return s&&window.clearTimeout(s)}}(e,n,S,u,i),function(){S(c.ReadyState.CLOSING),p(),v(),e.close(),f&&clearInterval(f)}}},19847:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.websocketWrapper=void 0;t.websocketWrapper=function(e,t){return new Proxy(e,{get:function(e,n){var r=e[n];return"reconnect"===n?t:"function"===typeof r?(console.error("Calling methods directly on the websocket is not supported at this moment. You must use the methods returned by useWebSocket."),function(){}):r},set:function(e,t,n){return/^on/.test(t)?(console.warn("The websocket's event handlers should be defined through the options object passed into useWebSocket."),!1):(e[t]=n,!0)}})},t.default=t.websocketWrapper},30426:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createOrJoinSocket=void 0;var r=n(64035),o=n(94494),a=n(18911),c=n(87434),s=n(38642);t.createOrJoinSocket=function(e,t,n,u,i,l,d,f,p){if(!o.isEventSourceSupported&&u.current.eventSourceOptions)throw o.isReactNative?new Error("EventSource is not supported in ReactNative"):new Error("EventSource is not supported");if(u.current.share){var v=null;void 0===r.sharedWebSockets[t]?(r.sharedWebSockets[t]=u.current.eventSourceOptions?new EventSource(t,u.current.eventSourceOptions):new WebSocket(t,u.current.protocols),e.current=r.sharedWebSockets[t],n(o.ReadyState.CONNECTING),v=(0,c.attachSharedListeners)(r.sharedWebSockets[t],t,u,p)):(e.current=r.sharedWebSockets[t],n(r.sharedWebSockets[t].readyState));var h={setLastMessage:i,setReadyState:n,optionsRef:u,reconnectCount:d,lastMessageTime:f,reconnect:l};return(0,s.addSubscriber)(t,h),function(e,t,n,a,c){return function(){if((0,s.removeSubscriber)(e,t),!(0,s.hasSubscribers)(e)){try{var u=r.sharedWebSockets[e];u instanceof WebSocket&&(u.onclose=function(e){n.current.onClose&&n.current.onClose(e),a(o.ReadyState.CLOSED)}),u.close()}catch(i){}c&&c(),delete r.sharedWebSockets[e]}}}(t,h,u,n,v)}if(e.current=u.current.eventSourceOptions?new EventSource(t,u.current.eventSourceOptions):new WebSocket(t,u.current.protocols),n(o.ReadyState.CONNECTING),!e.current)throw new Error("WebSocket failed to be created");return(0,a.attachListeners)(e.current,{setLastMessage:i,setReadyState:n},u,l.current,d,f,p)}},36811:(e,t,n)=>{t.vj=t.Ay=void 0;var r=n(44574);Object.defineProperty(t,"Ay",{enumerable:!0,get:function(){return r.useWebSocket}});var o=n(5605);var a=n(94494);Object.defineProperty(t,"vj",{enumerable:!0,get:function(){return a.ReadyState}});var c=n(77995);var s=n(2915)},38642:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetSubscribers=t.removeSubscriber=t.addSubscriber=t.hasSubscribers=t.getSubscribers=void 0;var n={},r=[];t.getSubscribers=function(e){return(0,t.hasSubscribers)(e)?Array.from(n[e]):r};t.hasSubscribers=function(e){var t;return(null===(t=n[e])||void 0===t?void 0:t.size)>0};t.addSubscriber=function(e,t){n[e]=n[e]||new Set,n[e].add(t)};t.removeSubscriber=function(e,t){n[e].delete(t)};t.resetSubscribers=function(e){if(e&&n.hasOwnProperty(e))delete n[e];else for(var t in n)n.hasOwnProperty(t)&&delete n[t]}},44574:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function c(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},c=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return c.next=s(0),c.throw=s(1),c.return=s(2),"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(u){s=[6,u],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useWebSocket=void 0;var s=n(9950),u=n(17119),i=n(94494),l=n(30426),d=n(93931),f=c(n(19847)),p=n(2915);t.useWebSocket=function(e,t,n){void 0===t&&(t=i.DEFAULT_OPTIONS),void 0===n&&(n=!0);var c=(0,s.useState)(null),v=c[0],h=c[1],S=(0,s.useState)({}),b=S[0],y=S[1],E=(0,s.useMemo)(function(){if(!t.disableJson&&v)try{return JSON.parse(v.data)}catch(e){return i.UNPARSABLE_JSON_OBJECT}return null},[v,t.disableJson]),O=(0,s.useRef)(null),m=(0,s.useRef)(null),g=(0,s.useRef)(function(){}),_=(0,s.useRef)(0),T=(0,s.useRef)(Date.now()),w=(0,s.useRef)([]),N=(0,s.useRef)(null),C=(0,s.useRef)(t);C.current=t;var x=O.current&&void 0!==b[O.current]?b[O.current]:null!==e&&!0===n?i.ReadyState.CONNECTING:i.ReadyState.UNINSTANTIATED,R=t.queryParams?JSON.stringify(t.queryParams):null,I=(0,s.useCallback)(function(e,t){var n;void 0===t&&(t=!0),i.isEventSourceSupported&&m.current instanceof EventSource?console.warn("Unable to send a message from an eventSource"):(null===(n=m.current)||void 0===n?void 0:n.readyState)===i.ReadyState.OPEN?((0,p.assertIsWebSocket)(m.current,C.current.skipAssert),m.current.send(e)):t&&w.current.push(e)},[]),k=(0,s.useCallback)(function(e,t){void 0===t&&(t=!0),I(JSON.stringify(e),t)},[I]),A=(0,s.useCallback)(function(){return!0!==C.current.share||i.isEventSourceSupported&&m.current instanceof EventSource?m.current:(null===N.current&&m.current&&((0,p.assertIsWebSocket)(m.current,C.current.skipAssert),N.current=(0,f.default)(m.current,g)),N.current)},[]);return(0,s.useEffect)(function(){if(null!==e&&!0===n){var t,c=!1,s=!0,f=function(){return o(void 0,void 0,void 0,function(){var n,o,f;return a(this,function(a){switch(a.label){case 0:return n=O,[4,(0,d.getUrl)(e,C)];case 1:return n.current=a.sent(),null===O.current?(console.error("Failed to get a valid URL. WebSocket connection aborted."),O.current="ABORTED",(0,u.flushSync)(function(){return y(function(e){return r(r({},e),{ABORTED:i.ReadyState.CLOSED})})}),[2]):(o=function(e){c||(0,u.flushSync)(function(){return h(e)})},f=function(e){c||(0,u.flushSync)(function(){return y(function(t){var n;return r(r({},t),O.current&&((n={})[O.current]=e,n))})})},s&&(t=(0,l.createOrJoinSocket)(m,O.current,f,C,o,g,_,T,I)),[2])}})})};return g.current=function(){c||(N.current&&(N.current=null),null===t||void 0===t||t(),f())},f(),function(){c=!0,s=!1,N.current&&(N.current=null),null===t||void 0===t||t(),h(null)}}null!==e&&!1!==n||(_.current=0,y(function(e){var t;return r(r({},e),O.current&&((t={})[O.current]=i.ReadyState.CLOSED,t))}))},[e,n,R,I]),(0,s.useEffect)(function(){x===i.ReadyState.OPEN&&w.current.splice(0).forEach(function(e){I(e)})},[x]),{sendMessage:I,sendJsonMessage:k,lastMessage:v,lastJsonMessage:E,readyState:x,getWebSocket:A}}},64035:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resetWebSockets=t.sharedWebSockets=void 0,t.sharedWebSockets={};t.resetWebSockets=function(e){if(e&&t.sharedWebSockets.hasOwnProperty(e))delete t.sharedWebSockets[e];else for(var n in t.sharedWebSockets)t.sharedWebSockets.hasOwnProperty(n)&&delete t.sharedWebSockets[n]}},73647:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.heartbeat=function(e,t,n){var o=n||{},a=o.interval,c=void 0===a?r.DEFAULT_HEARTBEAT.interval:a,s=o.timeout,u=void 0===s?r.DEFAULT_HEARTBEAT.timeout:s,i=o.message,l=void 0===i?r.DEFAULT_HEARTBEAT.message:i,d=Math.max(100,c/10),f=Date.now(),p=setInterval(function(){var n=Date.now(),r=function(e){if(Array.isArray(e))return e.reduce(function(e,t){return e.current>t.current?e:t}).current;return e.current}(t);if(r+u<=n)console.warn("Heartbeat timed out, closing connection, last message received ".concat(n-r,"ms ago, last ping sent ").concat(n-f,"ms ago")),e.close();else if(r+c<=n&&f+c<=n)try{"function"===typeof l?e.send(l()):e.send(l),f=n}catch(o){console.error("Heartbeat failed, closing connection",o instanceof Error?o.message:o),e.close()}},d);return e.addEventListener("close",function(){clearInterval(p)}),function(){}};var r=n(94494)},77995:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.useEventSource=void 0;var a=n(9950),c=n(44574),s=n(94494);t.useEventSource=function(e,t,n){void 0===t&&(t=s.DEFAULT_EVENT_SOURCE_OPTIONS);var u=t.withCredentials,i=t.events,l=o(t,["withCredentials","events"]);void 0===n&&(n=!0);var d=r(r({},l),{eventSourceOptions:{withCredentials:u}}),f=(0,a.useRef)(s.EMPTY_EVENT_HANDLERS);i&&(f.current=i);var p=(0,c.useWebSocket)(e,d,n),v=p.lastMessage,h=p.readyState,S=p.getWebSocket;return(0,a.useEffect)(function(){(null===v||void 0===v?void 0:v.type)&&Object.entries(f.current).forEach(function(e){var t=e[0],n=e[1];t===v.type&&n(v)})},[v]),{lastEvent:v,readyState:h,getEventSource:S}}},87434:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.attachSharedListeners=void 0;var o=n(64035),a=n(94494),c=n(38642),s=n(2311),u=n(73647);t.attachSharedListeners=function(e,t,n,i){var l;return n.current.fromSocketIO&&(l=(0,s.setUpSocketIOPing)(i)),function(e,t,n){e.onmessage=function(e){(0,c.getSubscribers)(t).forEach(function(t){var r;t.optionsRef.current.onMessage&&t.optionsRef.current.onMessage(e),"number"===typeof(null===(r=null===t||void 0===t?void 0:t.lastMessageTime)||void 0===r?void 0:r.current)&&(t.lastMessageTime.current=Date.now()),"function"===typeof t.optionsRef.current.filter&&!0!==t.optionsRef.current.filter(e)||n&&"boolean"!==typeof n&&(null===n||void 0===n?void 0:n.returnMessage)===e.data||t.setLastMessage(e)})}}(e,t,n.current.heartbeat),function(e,t){e instanceof WebSocket&&(e.onclose=function(e){(0,c.getSubscribers)(t).forEach(function(t){t.optionsRef.current.onClose&&t.optionsRef.current.onClose(e),t.setReadyState(a.ReadyState.CLOSED)}),delete o.sharedWebSockets[t],(0,c.getSubscribers)(t).forEach(function(t){var n;if(t.optionsRef.current.shouldReconnect&&t.optionsRef.current.shouldReconnect(e)){var r=null!==(n=t.optionsRef.current.reconnectAttempts)&&void 0!==n?n:a.DEFAULT_RECONNECT_LIMIT;if(t.reconnectCount.current<r){var o="function"===typeof t.optionsRef.current.reconnectInterval?t.optionsRef.current.reconnectInterval(t.reconnectCount.current):t.optionsRef.current.reconnectInterval;setTimeout(function(){t.reconnectCount.current++,t.reconnect.current()},null!==o&&void 0!==o?o:a.DEFAULT_RECONNECT_INTERVAL_MS)}else t.optionsRef.current.onReconnectStop&&t.optionsRef.current.onReconnectStop(t.optionsRef.current.reconnectAttempts),console.warn("Max reconnect attempts of ".concat(r," exceeded"))}})})}(e,t),function(e,t,n){e.onopen=function(r){var o=(0,c.getSubscribers)(t);o.forEach(function(t){t.reconnectCount.current=0,t.optionsRef.current.onOpen&&t.optionsRef.current.onOpen(r),t.setReadyState(a.ReadyState.OPEN),n&&e instanceof WebSocket&&(t.lastMessageTime.current=Date.now())}),n&&e instanceof WebSocket&&(0,u.heartbeat)(e,o.map(function(e){return e.lastMessageTime}),"boolean"===typeof n?void 0:n)}}(e,t,n.current.heartbeat),function(e,t){e.onerror=function(n){(0,c.getSubscribers)(t).forEach(function(t){t.optionsRef.current.onError&&t.optionsRef.current.onError(n),a.isEventSourceSupported&&e instanceof EventSource&&(t.optionsRef.current.onClose&&t.optionsRef.current.onClose(r(r({},n),{code:1006,reason:"An error occurred with the EventSource: ".concat(n),wasClean:!1})),t.setReadyState(a.ReadyState.CLOSED))}),a.isEventSourceSupported&&e instanceof EventSource&&e.close()}}(e,t),function(){l&&clearInterval(l)}}},93931:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function c(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(c,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},c=Object.create(("function"===typeof Iterator?Iterator:Object).prototype);return c.next=s(0),c.throw=s(1),c.return=s(2),"function"===typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;c&&(c=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(u){s=[6,u],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.getUrl=void 0;var c=n(2311),s=n(94494);t.getUrl=function(e,n){for(var u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];return r(void 0,a([e,n],u,!0),void 0,function(e,n,r){var a,u,i,l,d,f,p;return void 0===r&&(r=0),o(this,function(o){switch(o.label){case 0:if("function"!==typeof e)return[3,10];o.label=1;case 1:return o.trys.push([1,3,,9]),[4,e()];case 2:return a=o.sent(),[3,9];case 3:return o.sent(),n.current.retryOnError?(u=null!==(d=n.current.reconnectAttempts)&&void 0!==d?d:s.DEFAULT_RECONNECT_LIMIT,r<u?(i="function"===typeof n.current.reconnectInterval?n.current.reconnectInterval(r):n.current.reconnectInterval,[4,(v=null!==i&&void 0!==i?i:s.DEFAULT_RECONNECT_INTERVAL_MS,new Promise(function(e){return window.setTimeout(e,v)}))]):[3,5]):[3,7];case 4:return o.sent(),[2,(0,t.getUrl)(e,n,r+1)];case 5:return null===(p=(f=n.current).onReconnectStop)||void 0===p||p.call(f,r),[2,null];case 6:return[3,8];case 7:return[2,null];case 8:return[3,9];case 9:return[3,11];case 10:a=e,o.label=11;case 11:return l=n.current.fromSocketIO?(0,c.parseSocketIOUrl)(a):a,[2,n.current.queryParams?(0,c.appendQueryParams)(l,n.current.queryParams):l]}var v})})}},94494:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isEventSourceSupported=t.isReactNative=t.ReadyState=t.DEFAULT_HEARTBEAT=t.UNPARSABLE_JSON_OBJECT=t.DEFAULT_RECONNECT_INTERVAL_MS=t.DEFAULT_RECONNECT_LIMIT=t.SOCKET_IO_PING_CODE=t.SOCKET_IO_PATH=t.SOCKET_IO_PING_INTERVAL=t.DEFAULT_EVENT_SOURCE_OPTIONS=t.EMPTY_EVENT_HANDLERS=t.DEFAULT_OPTIONS=void 0;var n;t.DEFAULT_OPTIONS={},t.EMPTY_EVENT_HANDLERS={},t.DEFAULT_EVENT_SOURCE_OPTIONS={withCredentials:!1,events:t.EMPTY_EVENT_HANDLERS},t.SOCKET_IO_PING_INTERVAL=25e3,t.SOCKET_IO_PATH="/socket.io/?EIO=3&transport=websocket",t.SOCKET_IO_PING_CODE="2",t.DEFAULT_RECONNECT_LIMIT=20,t.DEFAULT_RECONNECT_INTERVAL_MS=5e3,t.UNPARSABLE_JSON_OBJECT={},t.DEFAULT_HEARTBEAT={message:"ping",timeout:6e4,interval:25e3},function(e){e[e.UNINSTANTIATED=-1]="UNINSTANTIATED",e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(n||(t.ReadyState=n={}));t.isReactNative="undefined"!==typeof navigator&&"ReactNative"===navigator.product,t.isEventSourceSupported=!t.isReactNative&&function(){try{return"EventSource"in globalThis}catch(e){return!1}}()}}]);