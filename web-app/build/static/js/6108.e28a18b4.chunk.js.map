{"version":3,"file":"static/js/6108.e28a18b4.chunk.js","mappings":"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","sources":["screens/Console/Buckets/BucketDetails/AddEvent.tsx","screens/Console/Common/ModalWrapper/ModalWrapper.tsx"],"sourcesContent":["// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport React, { useCallback, useEffect, useState, Fragment } from \"react\";\nimport {\n  Autocomplete,\n  Button,\n  DataTable,\n  EventSubscriptionIcon,\n  Grid,\n  InputBox,\n} from \"mds\";\nimport { ErrorResponseHandler } from \"../../../../common/types\";\nimport { setModalErrorSnackMessage } from \"../../../../systemSlice\";\nimport { useAppDispatch } from \"../../../../store\";\nimport { api } from \"api\";\nimport { NotificationEventType } from \"api/consoleApi\";\nimport ModalWrapper from \"../../Common/ModalWrapper/ModalWrapper\";\nimport {\n  formFieldStyles,\n  modalBasic,\n  modalStyleUtils,\n} from \"../../Common/FormComponents/common/styleLibrary\";\n\ninterface IAddEventProps {\n  open: boolean;\n  selectedBucket: string;\n  closeModalAndRefresh: () => void;\n}\n\nconst AddEvent = ({\n  open,\n  selectedBucket,\n  closeModalAndRefresh,\n}: IAddEventProps) => {\n  const dispatch = useAppDispatch();\n  const [addLoading, setAddLoading] = useState<boolean>(false);\n  const [prefix, setPrefix] = useState<string>(\"\");\n  const [suffix, setSuffix] = useState<string>(\"\");\n  const [arn, setArn] = useState<string>(\"\");\n  const [selectedEvents, setSelectedEvents] = useState<NotificationEventType[]>(\n    [],\n  );\n  const [arnList, setArnList] = useState<string[] | undefined>([]);\n\n  const addRecord = (event: React.FormEvent) => {\n    event.preventDefault();\n    if (addLoading) {\n      return;\n    }\n    setAddLoading(true);\n    api.buckets\n      .createBucketEvent(selectedBucket, {\n        configuration: {\n          arn: arn,\n          events: selectedEvents,\n          prefix: prefix,\n          suffix: suffix,\n        },\n        ignoreExisting: true,\n      })\n      .then(() => {\n        setAddLoading(false);\n        closeModalAndRefresh();\n      })\n      .catch((err: ErrorResponseHandler) => {\n        setAddLoading(false);\n        dispatch(setModalErrorSnackMessage(err));\n      });\n  };\n\n  const fetchArnList = useCallback(() => {\n    setAddLoading(true);\n    api.admin\n      .arnList()\n      .then((res) => {\n        if (res.data.arns !== null) {\n          setArnList(res.data.arns);\n        }\n        setAddLoading(false);\n      })\n      .catch((err: ErrorResponseHandler) => {\n        setAddLoading(false);\n        dispatch(setModalErrorSnackMessage(err));\n      });\n  }, [dispatch]);\n\n  useEffect(() => {\n    fetchArnList();\n  }, [fetchArnList]);\n\n  const events = [\n    { label: \"PUT - Object Uploaded\", value: NotificationEventType.Put },\n    { label: \"GET - Object accessed\", value: NotificationEventType.Get },\n    { label: \"DELETE - Object Deleted\", value: NotificationEventType.Delete },\n    {\n      label: \"REPLICA - Object Replicated\",\n      value: NotificationEventType.Replica,\n    },\n    { label: \"ILM - Object Transitioned\", value: NotificationEventType.Ilm },\n    {\n      label:\n        \"SCANNER - Object has too many versions / Prefixes has too many sub-folders\",\n      value: NotificationEventType.Scanner,\n    },\n  ];\n\n  const handleClick = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const targetD = event.target;\n    const value = targetD.value;\n    const checked = targetD.checked;\n\n    let elements: NotificationEventType[] = [...selectedEvents];\n\n    if (checked) {\n      elements.push(value as NotificationEventType);\n    } else {\n      elements = elements.filter((element) => element !== value);\n    }\n\n    setSelectedEvents(elements);\n  };\n\n  const arnValues = arnList?.map((arnConstant) => ({\n    label: arnConstant,\n    value: arnConstant,\n  }));\n\n  return (\n    <ModalWrapper\n      modalOpen={open}\n      onClose={() => {\n        closeModalAndRefresh();\n      }}\n      title=\"Subscribe To Bucket Events\"\n      titleIcon={<EventSubscriptionIcon />}\n    >\n      <form\n        noValidate\n        autoComplete=\"off\"\n        onSubmit={(e: React.FormEvent<HTMLFormElement>) => {\n          addRecord(e);\n        }}\n      >\n        <Grid container>\n          <Grid item xs={12} sx={modalBasic.formScrollable}>\n            <Grid\n              item\n              xs={12}\n              sx={{\n                ...formFieldStyles.formFieldRow,\n                \"& div div .MuiOutlinedInput-root\": {\n                  padding: 0,\n                },\n              }}\n            >\n              <Autocomplete\n                onChange={(value: string) => {\n                  setArn(value);\n                }}\n                id=\"select-access-policy\"\n                name=\"select-access-policy\"\n                label={\"ARN\"}\n                value={arn}\n                options={arnValues || []}\n                helpTip={\n                  <Fragment>\n                    <a\n                      target=\"blank\"\n                      href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/reference-arns.html\"\n                    >\n                      Amazon Resource Name\n                    </a>\n                  </Fragment>\n                }\n              />\n            </Grid>\n            <Grid item xs={12} sx={formFieldStyles.formFieldRow}>\n              <InputBox\n                id=\"prefix-input\"\n                name=\"prefix-input\"\n                label=\"Prefix\"\n                value={prefix}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                  setPrefix(e.target.value);\n                }}\n              />\n            </Grid>\n            <Grid item xs={12} sx={formFieldStyles.formFieldRow}>\n              <InputBox\n                id=\"suffix-input\"\n                name=\"suffix-input\"\n                label=\"Suffix\"\n                value={suffix}\n                onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n                  setSuffix(e.target.value);\n                }}\n              />\n            </Grid>\n            <Grid item xs={12} sx={formFieldStyles.formFieldRow}>\n              <DataTable\n                columns={[{ label: \"Event\", elementKey: \"label\" }]}\n                idField={\"value\"}\n                records={events}\n                onSelect={handleClick}\n                selectedItems={selectedEvents}\n                noBackground\n                customPaperHeight={\"260px\"}\n              />\n            </Grid>\n          </Grid>\n          <Grid item xs={12} sx={modalStyleUtils.modalButtonBar}>\n            <Button\n              id={\"cancel-add-event\"}\n              type=\"button\"\n              variant=\"regular\"\n              disabled={addLoading}\n              onClick={() => {\n                closeModalAndRefresh();\n              }}\n              label={\"Cancel\"}\n            />\n            <Button\n              id={\"save-event\"}\n              type=\"submit\"\n              variant=\"callAction\"\n              disabled={addLoading || arn === \"\" || selectedEvents.length === 0}\n              label={\"Save\"}\n            />\n          </Grid>\n        </Grid>\n      </form>\n    </ModalWrapper>\n  );\n};\n\nexport default AddEvent;\n","// This file is part of MinIO Console Server\n// Copyright (c) 2021 MinIO, Inc.\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\nimport React, { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { ModalBox, Snackbar } from \"mds\";\nimport { CSSObject } from \"styled-components\";\nimport { AppState, useAppDispatch } from \"../../../../store\";\nimport { setModalSnackMessage } from \"../../../../systemSlice\";\nimport MainError from \"../MainError/MainError\";\n\ninterface IModalProps {\n  onClose: () => void;\n  modalOpen: boolean;\n  title: string | React.ReactNode;\n  children: any;\n  wideLimit?: boolean;\n  titleIcon?: React.ReactNode;\n  iconColor?: \"default\" | \"delete\" | \"accept\";\n  sx?: CSSObject;\n}\n\nconst ModalWrapper = ({\n  onClose,\n  modalOpen,\n  title,\n  children,\n  wideLimit = true,\n  titleIcon = null,\n  iconColor = \"default\",\n  sx,\n}: IModalProps) => {\n  const dispatch = useAppDispatch();\n  const [openSnackbar, setOpenSnackbar] = useState<boolean>(false);\n\n  const modalSnackMessage = useSelector(\n    (state: AppState) => state.system.modalSnackBar,\n  );\n\n  useEffect(() => {\n    dispatch(setModalSnackMessage(\"\"));\n  }, [dispatch]);\n\n  useEffect(() => {\n    if (modalSnackMessage) {\n      if (modalSnackMessage.message === \"\") {\n        setOpenSnackbar(false);\n        return;\n      }\n      // Open SnackBar\n      if (modalSnackMessage.type !== \"error\") {\n        setOpenSnackbar(true);\n      }\n    }\n  }, [modalSnackMessage]);\n\n  const closeSnackBar = () => {\n    setOpenSnackbar(false);\n    dispatch(setModalSnackMessage(\"\"));\n  };\n\n  let message = \"\";\n\n  if (modalSnackMessage) {\n    message = modalSnackMessage.detailedErrorMsg;\n    if (message === \"\" || (message && message.length < 5)) {\n      message = modalSnackMessage.message;\n    }\n  }\n\n  return (\n    <ModalBox\n      onClose={onClose}\n      open={modalOpen}\n      title={title}\n      titleIcon={titleIcon}\n      widthLimit={wideLimit}\n      sx={sx}\n      iconColor={iconColor}\n    >\n      <MainError isModal={true} />\n      <Snackbar\n        onClose={closeSnackBar}\n        open={openSnackbar}\n        message={message}\n        mode={\"inline\"}\n        variant={modalSnackMessage.type === \"error\" ? \"error\" : \"default\"}\n        autoHideDuration={modalSnackMessage.type === \"error\" ? 10 : 5}\n        condensed\n      />\n      {children}\n    </ModalBox>\n  );\n};\n\nexport default ModalWrapper;\n"],"names":["_ref","open","selectedBucket","closeModalAndRefresh","dispatch","useAppDispatch","addLoading","setAddLoading","useState","prefix","setPrefix","suffix","setSuffix","arn","setArn","selectedEvents","setSelectedEvents","arnList","setArnList","fetchArnList","useCallback","api","admin","then","res","data","arns","catch","err","setModalErrorSnackMessage","useEffect","events","label","value","NotificationEventType","Put","Get","Delete","Replica","Ilm","Scanner","arnValues","map","arnConstant","_jsx","ModalWrapper","modalOpen","onClose","title","titleIcon","EventSubscriptionIcon","children","noValidate","autoComplete","onSubmit","e","preventDefault","buckets","createBucketEvent","configuration","ignoreExisting","_jsxs","Grid","container","item","xs","sx","modalBasic","formScrollable","_objectSpread","formFieldStyles","formFieldRow","padding","Autocomplete","onChange","id","name","options","helpTip","Fragment","target","href","InputBox","DataTable","columns","elementKey","idField","records","onSelect","event","targetD","checked","elements","push","filter","element","selectedItems","noBackground","customPaperHeight","modalStyleUtils","modalButtonBar","Button","type","variant","disabled","onClick","length","wideLimit","iconColor","openSnackbar","setOpenSnackbar","modalSnackMessage","useSelector","state","system","modalSnackBar","setModalSnackMessage","message","detailedErrorMsg","ModalBox","widthLimit","MainError","isModal","Snackbar","closeSnackBar","mode","autoHideDuration","condensed"],"sourceRoot":""}